$(function () {

    //点击回到主页
    $("#goindex").on("click",function () {
        window.open("index.html","_self")
    });
    //点击回到优惠券主页
    $(".gocoupon").on("click",function () {
        window.open("coupon.html","_self")
    });

    //获取url是否有参数，判断加载什么内容v
    var URL = window.location.search;
    console.log(URL.split(":")[1]);
    if(URL.split(":")[1] != undefined){
        getcouponProduct(URL.split(":")[1]);
        if(URL.split(":")[1] == 1){
            $("#shopname").text("必胜客优惠券");
        }else if(URL.split(":")[1] == 2){
            $("#shopname").text("棒约翰优惠券");
        }else if(URL.split(":")[1] == 3){
            $("#shopname").text("哈根达斯优惠券");
        }
    }else{
        //没有传参 默认获取肯德基数据
        getcouponProduct(0);
    }



    //回到顶部
    $(".gotop").on("click", function () {
        $('body,html').animate({scrollTop: 0}, 500);
        return false;
    });

    //渲染页面
    function getcouponProduct(couponid) {
        $.ajax({
            type: "get",
            url: "http://139.199.157.195:9090/api/getcouponproduct",
            data: {"couponid": couponid},
            success: function (res) {
                var html = "";
                html += template("couponProduct",res);
                $(".couponProduct").append(html);
            }
        });
    }


    //设置点击li标签，图片显示在中间
    $(".couponProduct").on("click","li",function () {
        var imgsrc = $(this).children("a").children("img").attr("src");
        $(".bigImg").html("<img src="+ imgsrc + ">").fadeIn();

    });

    //点击关闭遮罩图片
    $(".bigImg").on("click",function () {
        $(this).hide();
    })
});